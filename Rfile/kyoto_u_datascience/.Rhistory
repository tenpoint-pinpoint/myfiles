dat<-read.csv("data__ch2.csv", header=TRUE)
dat<-read.csv("data_ch2.csv", header=TRUE)
dat
head(dat)
head(dat)
dat.2 <- read.csv(file.choose(), header = TRUE)
head(dat.2)
dat.2 <- read.csv(file.choose(), header = TRUE)
dat.2
1+1
1+1
install.packages("psych", dependencies = TRUE)
dat.3 <- read.csv(file.choose(), header = TRUE, row.names = 1)
dat.3
dat.3 <- read.csv(file.choose(), header = TRUE, row.names = 1)
dat.3 <- read.csv(file.choose(), header = TRUE, row.names = 1)
dat.3 <- read.csv(file.choose(), header = TRUE, row.names = 1)
dat.3
dat.3 <- read.csv(file.choose(), header = TRUE, row.names = 1)
dat.3 <- read.csv(file.choose(), header = TRUE, row.names = 1,fileEncoding=”CP932″)
dat.3 <- read.csv(file.choose(), header = TRUE, row.names = 1, fileEncoding="CP932")
dat.3
head(dat.3)
install.packages("lattice", dependencies = TRUE)
View(dat.3)
View(dat.3)
dat.3 <- read.csv("data_ch3.csv", header = TRUE, fileEncoding="CP932")
dat.3 <- read.csv("data_ch3.csv")
dat.3 <- read.csv(file.choose(), header = TRUE, row.names = 1, fileEncoding="CP932")
dat.2 <- read.csv(file.choose(), header = TRUE)
dat.2 <- read.csv(file.choose(), header = TRUE)
dat.2 <- read.csv(file.choose(), header = TRUE)
dat.2 <- read.csv("data_ch2.csv", header = TRUE,fileEncoding="CP932")
getwd()
dat.2 <- read.csv("data_ch2.csv", header = TRUE)
dat.2 <- read.csv(file.choose(), header = TRUE)
head(dat.2)
dat.2 <- read.csv(file.choose(), header = TRUE)
head(dat.2)
dat.2 <- read.csv(file.choose(), header = TRUE)
head(dat.2)
dat.4 <- read.csv(file.choose(), header = TRUE)
head(dat.4)
dim(dat)
dat4 <- read.csv(file.choose(), header = TRUE)
head(dat4)
dim(dat4)
dat4 <- na.omit(dat)
dat4 <- na.omit(dat4)
dim(dat4)
table(dat4$class)
table(dat4$class, dat4$sex)
library("lattice")
library("beeswarm")
install.packages("beeswarm")
install.packages("car", dependencies = TRUE)
library("car")
leveneTest(dat4$score, dat4$class, center = mean)
t.test(dat4$score ~ dat4$class, var.equal=T)
table(dat4$class, dat4$sex)
describeBy(dat4$score, dat4$class)
library("beeswarm")
describeBy(dat4$score, dat4$class)
t.test(dat4$score ~ dat4$class, var.equal=T)
t.test(dat4$score ~ dat4$class)
dat.3 <- read.csv(file.choose(), header = TRUE)
install.packages("gplots", dependencies = TRUE)
install.packages("beeswarm", dependencies = TRUE)
install.packages("beeswarm", dependencies = TRUE)
describeBy(dat4$score, dat4$class)
library("beeswarm")
describeBy(dat4$score, dat4$class)
install.packages("lattice", dependencies = TRUE)
library("psych")
install.packages("foreign", dependencies = TRUE)
library("foreign")
describeBy(dat4$score, dat4$class)
head(dat.3)
# 行数と列数の確認
dim(dat.3)
# preとpostの列に欠損値がないか確認（TRUEがあれば，欠損値がある）
table(is.na(dat.3[3 : 4]))
# 男女の学習者数
table(dat.3$sex)
hist(dat.3$pre, col = rgb(1, 0, 0, 0.5), xlim = c(30, 100), ylim = c(0, 15), main = "Overlapping Histogram", xlab = "score")
hist(dat.3$post, col = rgb(0, 0, 1, 0.5), add = TRUE)
hist(dat.3$pre, col = rgb(1, 0, 0, 0.5), xlim = c(30, 100), ylim = c(0, 15), main = "Overlapping Histogram", xlab = "score")
hist(dat.3$post, col = rgb(0, 0, 1, 0.5))
score <- c(dat.3$pre, dat.3$post)
group <- factor(c(rep("pre", 30), rep("post", 30)), levels = c("pre","post"))
boxplot(score ~ group, ylim = c(0, 100), main = "Result of the Pre-Post Test", xlab = "test", ylab = "score")
beeswarm(score ~ group, ylim = c(0, 100), pch = 16, add = TRUE)
describe(dat.3[, 3 : 4])
t.test(dat.3$pre, dat.3$post, paired = TRUE)
options(scipen = 10)
2.813e-05
cor(dat.3$pre, dat.3$post)
install.packages("latticeExtra", dependencies = TRUE)
# パッケージの読み込み
library("lattice")
library("latticeExtra")
df <- data.frame(score, group)
df$indiv <- factor(c(rep(1 : nrow(dat.3)), rep(1 : nrow(dat.3))))
each <- xyplot(score ~ group, group = indiv, type = c("l"), data = df, xlab = "test", ylab = "score")
all_mean <- c(mean(dat.3$pre), mean(dat.3$post))
fact <- factor(c("pre", "post"), levels = c("pre","post"))
all <- xyplot(all_mean ~ fact, col = "black", lwd = 5, type = c("l"), data = df)
each + as.layer(all, axes = NULL)
plot(dat.3$pre, dat.3$post, las = 1, pch = 16, xlab = "pretest", ylab = "posttest", main = NA, xlim = c(0, 100), ylim = c(0, 100))
lines(par()$usr[1 : 2], par()$usr[3 : 4], lty = 3)
source('~/Documents/R関連/kyoto_u_datascience/chapter4.R', encoding = 'SHIFT-JIS')
dat <- read.csv(file.choose(), header = TRUE)
install.packages("coin", dependencies = TRUE)
library("coin")
res <- wilcox_test(dat$score ~ factor(dat$class), distribution = "exact")
res
# res@statistic@teststatisticは，上の結果のZ値と同じ
r <- abs(res@statistic@teststatistic) / sqrt(length(dat$score))
r
library("psych")
r.con(r, length(dat$score), p = .95, twotailed = TRUE)
dat.2 <- read.csv(file.choose(), header = TRUE)
# Wilcoxonの符号付順位和検定
# パッケージのインストール（初回のみ）
install.packages("exactRankTests", dependencies = TRUE)
# パッケージの読み込み
library("exactRankTests")
res.2 <- wilcox.exact(dat.2$pre, dat.2$post, paired = TRUE)
res.2
# 効果量rの計算
z <- qnorm(1 - (res.2$p.value / 2))
r <- z / sqrt(length(dat.2$pre) * 2)
r
# 効果量rの95%信頼区間の算出
r.con(r, length(dat.2$pre * 2), p =.95, twotailed = TRUE)
z<- c(9,40,11,17,23)
names(z) <- ("大反対","反対","中立","賛成","大賛成")
names(z) <- c("大反対","反対","中立","賛成","大賛成")
result <-chisq.test(z)
result
z2 <- matrix(c(3,12,12,3,9,16,98,17),
ncol = 2, nrow = 4, byrow = T)
z2 <- matrix(c(3,12,12,3,9,16,98,17),
ncol = 2, nrow = 4, byrow = T)
rownames(z2) <- c("国語","算数","社会","理科")
colnames(z2) <- c("男児","女児")
z2
result <-chisq.test(z2)
result
result2 <-chisq.test(z2)
result2
result$residuals
result$stdres
z2 <- matrix(c(3,12,12,3,9,16,8,17),
ncol = 2, nrow = 4, byrow = T)
rownames(z2) <- c("国語","算数","社会","理科")
colnames(z2) <- c("男児","女児")
result2 <-chisq.test(z2)
result2
result$residuals
#調整済み残差
result$stdres
z2
dat <- read.csv(file.choose(), header = TRUE)
dat.2 <- na.omit(dat[, 1 : 6])
head(dat.2)
summary(dat.2[, 5 : 6])
cor(dat.2$mid, dat.2$end, method = "pearson")
cor.test(dat.2$mid, dat.2$end, method = "pearson")
plot(dat.2$mid, dat.2$end,
# ドットの大きさを変更
cex = 1.2,
# x軸・y軸のラベルと範囲を変更，タイトルを表示
xlab = "中間テスト得点", xlim = c(0, 100),
ylab = "期末テスト得点", ylim = c(0, 100))
# 散布図に切片a = 0，傾きb = 1の直線を表示
abline(a = 0, b = 1, lty = 1)
library("psych")
# 中間試験（5列目）と期末試験（6列目）の散布図を作成
pairs.panels(dat.2[, 5 : 6],
# 回帰直線（黒色）とその95%信頼区間を表示
lm = TRUE, ci = TRUE, col = "black",
# ヒストグラムの色を変更
hist.col = "grey",
# ドットのスタイルを変更
pch = 21,
# 有意な相関係数にアスタリスクを付ける
stars = TRUE,
# 平滑線（smooth）と相関円（ellipses）を描写しない
smooth = FALSE, ellipses = FALSE)
cor(dat.2$mid[dat.2$faculty == "F01"], dat.2$end[dat.2$faculty == "F01"], method = "pearson")
library("lattice")
# 中間試験と期末試験の散布図を学科別にプロット（実行結果は省略）
xyplot(mid ~ end | faculty, data = dat.2,
# 中間の点数が80点以上か否かで色分け，異なるマーカーを使用
groups = mid >= 80, col = c("grey20", "grey40"),
pch = c(1, 16), cex = c(1.0, 1.0),
# 中間試験と期末試験の平均点ラインを描写
abline = list(h = mean(dat.2$mid),v = mean(dat.2$end),
col = "grey"))
# F01~F09の順番を並び替えることも可能
dat.2$faculty <- factor(dat.2$faculty,
levels = c("F07", "F08", "F09", "F04", "F05", "F06",
"F01", "F02", "F03"))
xyplot(mid ~ end | faculty, data = dat.2,
groups = mid >= 80, col = c("grey20", "grey40"),
pch = c(1, 16), cex = c(1.0, 1.0),
abline = list(h = mean(dat.2$mid),v = mean(dat.2$end),
col = "grey"))
dat.3 <- na.omit(dat[, 7 : 9])
# Spearmanの相関係数を計算
cor(dat.3, method = "spearman")
col = "grey"))
dat.3
# Spearmanの相関係数を計算
cor(dat.3, method = "spearman")
res <- corr.test(dat.3, method = "spearman")
print(res, short = FALSE)
plot(dat.3)
ques <- xtabs( ~ manzoku + rikai, data = dat.3)
ques
library("gplots")
# 気球グラフのプロット
balloonplot(ques)
dat <- read.csv(file.choose(), header = TRUE)
head(dat)
dim(dat)
# クラス別の学習者数
table(dat$class)
library("psych")
describeBy(dat$score, dat$class)
library("car")
leveneTest(dat$score, dat$class, center = mean)
boxplot(dat$score ~ dat$class, col = "grey", ylim = c(0, 100), main = "3クラスの比較", xlab = "class", ylab = "score")
beeswarm(dat$score ~ dat$class, ylim = c(0, 100), pch = 16, add = TRUE)
source("anovakun_485.txt")
anovakun(dat[, -1], "As", 3, holm = TRUE, eta = TRUE)
dat <- read.csv(file.choose(), header = TRUE, row.names = 1)
subset(dat, complete.cases(dat) == FALSE)
dat.2 <- na.omit(dat[, 1 : 2])
# 中間と期末の成績を抽出し，NAを含む行を削除したデータの冒頭を確認
head(dat.2)
d <- mahalanobis(dat.2, apply(dat.2, 2, mean), cov(dat.2))
# データの行数と列数の計算
n <- nrow(dat.2)
v <- ncol(dat.2)
out <- n * (n - v) / ((n ^ 2 - 1) * v) * d > qf(0.9, n, v)
# 散布図に外れ値を表示
plot(dat.2, pch = ifelse(out, 16, 21), xlim = c(0, 100), ylim = c(0, 100), xlab = "中間試験", ylab = "期末試験")
d <- mahalanobis(dat.2, apply(dat.2, 2, mean), cov(dat.2))
plot(dat.2, pch = ifelse(out, 16, 21), xlim = c(0, 100), ylim = c(0, 100), xlab = "中間試験", ylab = "期末試験")
# 外れ値の行番号とラベルを表示
text(dat.2[out, ] - 3, labels = paste(which(out), ":", rownames(dat.2)[out]))
# 外れ値の除外
dat.3 <- dat.2[-which(out == TRUE), ]
model.1 <- lm(end ~ mid, data = dat.3)
summary(model.1)
plot(dat.3, xlim = c(0, 100), ylim = c(0, 100), xlab = "中間試験", ylab = "期末試験")
abline(model.1)
dat.3z <- scale(dat.3)
dat.3z <- data.frame(dat.3z)
attach(dat.3z)
model.lz <- lm(end~mid, data = dat.3z)
summary(model.lz)
col(end,mid)
col(end,mid,data=dat.3)
col(end, mid)
cor(end, mid)
z2 <- matrix(c(3,12,12,3,9,16,8,17),
ncol = 2, nrow = 4, byrow = T)
rownames(z2) <- c("国語","算数","社会","理科")
colnames(z2) <- c("男","女")
z2
result01 <- chisp.test(z2)
result01 <- chisq.test(z2)
result01
result01$residuals
#こっちは調整済み残差
result01$stdres
pnorm(abs(result01$stdres), lower.tail = FALSE) *2
source("http://aoki2.si.gunma-u.ac.jp/R/src/p_multi_comp.R", encoding="euc-jp")
p.multi.comp(c(15,15,25,25),c(3,12,9,8), method="ryan")
