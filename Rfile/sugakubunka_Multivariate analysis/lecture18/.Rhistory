# デモデータセットの作成
data(iris)    # irisデータの読み込み
dat <- iris[iris$Species %in% c("versicolor", "virginica"),
c("Petal.Length", "Petal.Width", "Species")]
dat$Species <- factor(dat$Species, levels = c("versicolor", "virginica"))
head(dat, n = 5)
plot(dat, col = dat$Species)
library(MASS)
result <- qda(Species ~ Petal.Length + Petal.Width, data = dat)
result
# R言語のpredict関数で計算した判別得点
pred <- predict(result, dat[1, c("Petal.Length", "Petal.Width")])
pred$class
# R言語のpredict関数で計算した判別得点
pred <- predict(result, dat[1, c("Petal.Length", "Petal.Width")])
pred$class
# versicolor群の標本平均と分散共分散行列
dat_versi <- dat[dat$Species == "versicolor",
c("Petal.Length", "Petal.Width")]
xbar_versi <- apply(dat_versi, MARGIN = 2, FUN = mean)
cov_versi <- cov(dat_versi)
# virginica群の標本平均と分散共分散行列
dat_virgi <- dat[dat$Species == "virginica",
c("Petal.Length", "Petal.Width")]
xbar_virgi <- apply(dat_virgi, MARGIN = 2, FUN = mean)
cov_virgi <- cov(dat_virgi)
x <- dat[1, c("Petal.Length", "Petal.Width")]
d_versi <- mahalanobis(x = x, center = xbar_versi, cov = cov_versi)
d_virgi <- mahalanobis(x = x, center = xbar_virgi, cov = cov_virgi)
- d_versi + d_virgi
Sm <- cov(dat[dat$Species == "versicolor", c("Petal.Length", "Petal.Width")])
Sp <- cov(dat[dat$Species == "virginica", c("Petal.Length", "Petal.Width")])
SW <- 1/(100-2) * ((50-1)*Sm + (50-1)*Sp)
coef <- t(xbar_versi - xbar_virgi) %*% solve(SW)
coef
result <- lda(Species ~ Petal.Length + Petal.Width, data = dat)
coef / as.vector(result$scaling)
##### データの読み込み #####
library(Zelig)    # coalitionデータセット
data(coalition)
head(coalition, n = 5)
# 切片のみのモデル
# これをnull modelとよぶのだった。
result0 <- glm(duration ~ 1, data = coalition,
family = Gamma(link = "inverse"))
summary(result0)    # 実際 null deviance = residual devianceが成り立つ。
# fractを説明変数に追加したモデル
result1 <- glm(duration ~ fract, data = coalition,
family = Gamma(link = "inverse"))
summary(result1)
# 尤度比検定
# residual devianceとnull devianceの差 ~ 自由度1のカイ2乗分布
anova(result0, result1)
pchisq(q = 22.556, df = 1)
1-pchisq(q = 22.556, df = 1)
# fractを説明変数に追加したモデル
result1 <- glm(duration ~ fract, data = coalition,
family = Gamma(link = "inverse"))
summary(result1)
# 切片のみのモデル
# これをnull modelとよぶのだった。
result0 <- glm(duration ~ 1, data = coalition,
family = Gamma(link = "inverse"))
summary(result0)    # 実際 null deviance = residual devianceが成り立つ。
# fractを説明変数に追加したモデル
result1 <- glm(duration ~ fract, data = coalition,
family = Gamma(link = "inverse"))
summary(result1)
# 尤度比検定
# residual devianceとnull devianceの差 ~ 自由度1のカイ2乗分布
anova(result0, result1)
# fractを説明変数に追加したモデル
result1 <- glm(duration ~ fract, data = coalition,
family = Gamma(link = "inverse"))
summary(result1)
# fractを説明変数に追加したモデル
result1 <- glm(duration ~ fract, data = coalition,
family = Gamma(link = "inverse"))
summary(result1)
setwd("~/Desktop/すうがくぶんか/集団授業/続初級統計学_改訂/lecture18")
# パッケージのインストールと読み込み
# install.packages("lavaan")
library(lavaan)
x <- mvrnorm(n = 100, mu = c(0, 0), Sigma = matrix(c(1,0.4,0.4,1),2,2))
library(MASS)
x <- mvrnorm(n = 100, mu = c(0, 0), Sigma = matrix(c(1,0.4,0.4,1),2,2))
x
library(MASS)
x <- mvrnorm(n = 25, mu = c(0, 0), Sigma = matrix(c(1,0.4,0.4,1),2,2))
初級統計学 <- round(8 * x[,1] + 72)
基礎からのR <- round(6 * x[,2] + 78)
続初級統計学 <- round(-10 + 0.5*初級統計学 + 0.5*基礎からのR + 9*rnorm(n = 25))
数理統計学 <- round(-20 + 0.7*初級統計学 + 0.2*基礎からのR + 5*rnorm(n = 25))
dat <- data.frame(初級統計学, 基礎からのR, 続初級統計学, 数理統計学)
summary(dat)
?write.csv
write.csv(x = dat, file = "./data/seiseki.csv", row.names = FALSE)
write.csv(x = dat, file = "./data/seiseki.csv", row.names = FALSE)
# データの読み込み
dat <- read.csv("seiseki.csv", fileEncoding = "utf-8")
head(dat, n = 5)
# データの読み込み
dat <- read.csv("./data/seiseki.csv", fileEncoding = "utf-8")
head(dat, n = 5)
# データの読み込み
dat <- read.csv("./data/seiseki.csv", fileEncoding = "utf-8")
head(dat, n = 5)
model <- "
# 変数間の相関関係
初級統計学 ~ 基礎からのR
# 構造方程式
続初級統計学 ~ 初級統計学 + 基礎からのR
数理統計学 ~ 初級統計学 + 基礎からのR
"
?sem
result <- sem(model = model, data = dat)
summary(result)
result <- sem(model = model, data = dat)
plot(result)
# パッケージのインストールと読み込み
# install.packages("lavaan")
# install.packages("semPlot")
library(lavaan)
library(semPlot)
result <- sem(model = model, data = dat)
semPaths(result)
result <- sem(model = model, data = dat)
par(family = "ヒラギノ角ゴシック W3")
semPaths(result)
model <- "
# 変数間の相関関係
初級統計学 ~~ 基礎からのR
# 構造方程式
続初級統計学 ~ 初級統計学 + 基礎からのR
数理統計学 ~ 初級統計学 + 基礎からのR
"
result <- sem(model = model, data = dat)
par(family = "ヒラギノ角ゴシック W3")
semPaths(result)
?semPaths
result <- sem(model = model, data = dat)
par(family = "ヒラギノ角ゴシック W3")
semPaths(result, what = "est")
result <- sem(model = model, data = dat)
par(family = "ヒラギノ角ゴシック W3")
semPaths(result, "model", "est")
summary(result)
model <- "
# 誤差の分散
初級統計学 ~~ 初級統計学
基礎からのR ~~ 基礎からのR
続初級統計学 ~~ 続初級統計学
数理統計学 ~~ 数理統計学
# 変数間の相関関係
初級統計学 ~~ 基礎からのR
# 構造方程式
続初級統計学 ~ 1 + 初級統計学 + 基礎からのR
数理統計学 ~ 1 + 初級統計学 + 基礎からのR
"
result <- sem(model = model, data = dat)
par(family = "ヒラギノ角ゴシック W3")
semPaths(result, "model", "est")
summary(result)
model <- "
# 変数間の相関関係
初級統計学 ~~ 基礎からのR
# 構造方程式
続初級統計学 ~ 1 + 初級統計学 + 基礎からのR
数理統計学 ~ 1 + 初級統計学 + 基礎からのR
"
result <- sem(model = model, data = dat)
par(family = "ヒラギノ角ゴシック W3")
semPaths(result, "model", "est")
summary(result)
result <- sem(model = model, data = scale(dat))
par(family = "ヒラギノ角ゴシック W3")
semPaths(result, "model", "est")
model <- "
# 変数間の相関関係
初級統計学 ~~ 基礎からのR
# 構造方程式
続初級統計学 ~ 初級統計学 + 基礎からのR
数理統計学 ~ 初級統計学 + 基礎からのR
"
result <- sem(model = model, data = scale(dat))
par(family = "ヒラギノ角ゴシック W3")
semPaths(result, "model", "est")
result <- sem(model = model, data = scale(dat), standardized = TRUE)
result <- sem(model = model, data = scale(dat))
par(family = "ヒラギノ角ゴシック W3")
semPaths(result, "model", "stand")
summary(result)
summary(result, standardized = TRUE)
model <- "
# 変数間の相関関係
初級統計学 ~~ 基礎からのR
# 構造方程式
続初級統計学 ~ 初級統計学 + 基礎からのR
数理統計学 ~ 初級統計学 + 基礎からのR
"
result <- sem(model = model, data = scale(dat))
par(family = "ヒラギノ角ゴシック W3")
summary(result)
result <- sem(model = model, data = scale(dat))
par(family = "ヒラギノ角ゴシック W3")
summary(result, rsquare = TRUE)
model
cov(dat)
model <- "
# 変数間の相関関係
初級統計学 ~~ 基礎からのR
続初級統計学 ~~ 0*数理統計学    # 相関がないことを明示する。
# 構造方程式
続初級統計学 ~ 初級統計学 + 基礎からのR
数理統計学 ~ 初級統計学 + 基礎からのR
"
result <- sem(model = model, data = scale(dat))
par(family = "ヒラギノ角ゴシック W3")
summary(result, rsquare = TRUE)
semPaths(result, "model", "stand")
par(family = "ヒラギノ角ゴシック W3")
semPaths(result, "model", "stand", sizeMan = 10, edge.label.cex = 2.0)
par(family = "ヒラギノ角ゴシック W3")
semPaths(result, "model", "stand", sizeMan = 5, edge.label.cex = 1.0)
_sem
?sem
model <- "
# 変数間の相関関係
初級統計学 ~~ c*基礎からのR
続初級統計学 ~~ 0*数理統計学    # 相関がないことを明示する。
# 構造方程式
続初級統計学 ~ a*初級統計学 + b*基礎からのR
数理統計学 ~ 初級統計学 + 基礎からのR
# 興味のある効果の定義
total :=  a + b*c
"
result <- sem(model = model, data = scale(dat))
summary(result, rsquare = TRUE)
0.183 + 0.273*0.196
model <- "
# 変数間の相関関係
初級統計学 ~~ c*基礎からのR
続初級統計学 ~~ 0*数理統計学    # 相関がないことを明示する。
# 構造方程式
続初級統計学 ~ a*初級統計学 + b*基礎からのR
数理統計学 ~ 初級統計学 + 基礎からのR
# 興味のある効果の定義
total :=  a + b*c
direct := a
indirect := b*c
"
result <- sem(model = model, data = scale(dat))
summary(result, rsquare = TRUE)
par(family = "ヒラギノ角ゴシック W3")
semPaths(result, "model", "stand", sizeMan = 5, edge.label.cex = 1.0)
model <- "
# 変数間の相関関係
初級統計学 ~~ 基礎からのR
続初級統計学 ~~ 数理統計学    # 相関がないことを明示する。
# 構造方程式
続初級統計学 ~ 初級統計学 + 基礎からのR
数理統計学 ~ 初級統計学 + 基礎からのR
"
result <- sem(model = model, data = scale(dat))
summary(result, rsquare = TRUE)
1-0.836
result <- sem(model = model, data = dat)
summary(result, rsquare = TRUE)
par(family = "ヒラギノ角ゴシック W3")
semPaths(result, "model", "stand", sizeMan = 5, edge.label.cex = 1.0)
0.286^2*40.234+0.675^2*16+1*5.184*sqrt(40.234*16)
model <- "
# 変数間の相関関係
初級統計学 ~~ 基礎からのR
続初級統計学 ~~ 0*数理統計学    # 相関がないことを明示する。
# 構造方程式
続初級統計学 ~ 初級統計学 + 基礎からのR
数理統計学 ~ 初級統計学 + 基礎からのR
"
result <- sem(model = model, data = dat)
summary(result, rsquare = TRUE)
par(family = "ヒラギノ角ゴシック W3")
semPaths(result, "model", "stand", sizeMan = 5, edge.label.cex = 1.0)
par(family = "ヒラギノ角ゴシック W3")
semPaths(result, "model", "est", sizeMan = 5, edge.label.cex = 1.0)
0.286^2*40.234 + 0.675^2*16.00 + 2*0.286*0.675*5.184 + 85.023
0.286^2*40.234 + 0.675^2*16.00 + 2*0.286*0.675*5.184 + 85.023
1 - 85.023 / 97.60552
