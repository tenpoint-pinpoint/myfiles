library(tidyverse)
library(ggplot2)
add_x <- c(2.5,3,3.5)
add_y <- c(25,27.5,30)
ggplot(data = mpg, mapping = aes(x = displ, y = cty)) +
geom_point() +
annotate(geom = "point", x = add_x, y = add_y, color = "red") +
annotate(geom = "text", x = c(5,5), y = c(30,25), label = c("要チェック！","赤色のデータを追加"),family = "HiraKakuProN-W3") +
theme_gray(base_family = "HiraKakuProN-W3")
library(tidyverse)
library(skimr)
# ------------------------------------------------------------------------------------------
# 練習問題
# ------------------------------------------------------------------------------------------
# データ読み込み
titanic <- read_csv("/Users/yoshikawahiroshi/Documents/R_lesson_tidyverse/r_lesson_4th/titanic.csv")
# データの整形
titanic %>% skim()
# 変数Cabin, ChiOrAdを削除した後に欠損値をリストワイズ削除する
#　リストワイズ削除 → 解析対象とされる複数の変数のどれか１つでも欠損価を持つ場合、計算から除外すること
titanic <- titanic %>%
select(-c(Cabin, ChiOrAd)) %>%
na.omit() #リストワイズ削除している。欠損値の取り扱いを（）内で規定することもある
titanic %>% skim()
# (17) PclassごとのAgeの箱ひげ図の作成する
ggplot(data = titanic, mapping = aes(x = Pclass, y = Age)) +
geom_boxplot()
ggplot(iris, mapping = aes(x = Species, y = Petal.Width)) +
geom_boxplot()
titanic
# (17) PclassごとのAgeの箱ひげ図の作成する
ggplot(data = titanic, mapping = aes(x = Pclass, y = Age)) +
geom_boxplot()
iris
titanic
titanic %>%
mutate_at(Pclass,at.character)
titanic %>%
mutate_at("Pclass",at.character)
titanic %>%
mutate_at("Pclass",is.character)
# (17) PclassごとのAgeの箱ひげ図の作成する
ggplot(data = titanic, mapping = aes(x = Pclass, y = Age)) +
geom_boxplot()
titanic %>%
mutate_at("Pclass",is.double)
titanic %>%
mutate_at("Pclass",is.double)
# ------------------------------------------------------------------------------------------
# 練習問題
# ------------------------------------------------------------------------------------------
# データ読み込み
titanic <- read_csv("/Users/yoshikawahiroshi/Documents/R_lesson_tidyverse/r_lesson_4th/titanic.csv")
# データの整形
titanic %>% skim()
# 変数Cabin, ChiOrAdを削除した後に欠損値をリストワイズ削除する
#　リストワイズ削除 → 解析対象とされる複数の変数のどれか１つでも欠損価を持つ場合、計算から除外すること
titanic <- titanic %>%
select(-c(Cabin, ChiOrAd)) %>%
na.omit() #リストワイズ削除している。欠損値の取り扱いを（）内で規定することもある
titanic %>% skim()
# ------------------------------------------------------------------------------------------
# 練習問題
# ------------------------------------------------------------------------------------------
# データ読み込み
titanic <- read_csv("/Users/yoshikawahiroshi/Documents/R_lesson_tidyverse/r_lesson_4th/titanic.csv")
# (17) PclassごとのAgeの箱ひげ図の作成する
ggplot(data = titanic, mapping = aes(x = Pclass, y = Age)) +
geom_boxplot()
# データの整形
titanic %>% skim()
# 変数Cabin, ChiOrAdを削除した後に欠損値をリストワイズ削除する
#　リストワイズ削除 → 解析対象とされる複数の変数のどれか１つでも欠損価を持つ場合、計算から除外すること
titanic <- titanic %>%
select(-c(Cabin, ChiOrAd)) %>%
na.omit() #リストワイズ削除している。欠損値の取り扱いを（）内で規定することもある
titanic %>% skim()
# (1) Ageのヒストグラムを作成する(ビンの数を20に固定)
ggplot() +
geom_histogram(data = titanic, mapping = aes(x = Age), bins = 20)
titanic %>% skim()
titanic
View(titanic)
# PclassとSurvivedをchr型に変換する
titanic <- titanic %>% mutate(Survived = as.character(Survived),
Pclass = as.character(Pclass))
titanic %>% skim()
titanic
# (17) PclassごとのAgeの箱ひげ図の作成する
ggplot(data = titanic, mapping = aes(x = Pclass, y = Age)) +
geom_boxplot()
# (18) (17)の箱ひげ図にデータ点を追加する
titanic %>% ggplot(aes(x = Pclass, y = Age)) +
geom_boxplot() +
geom_jitter()
# (20) PclassごとのAgeのバイオリンプロットを作成する(データ数を面積に反映させる)
titanic %>% ggplot(aes(x = Pclass, y = Age)) +
geom_violin(scale = "area")
# (21) PclassごとのAgeの平均値を棒グラフで表示する
ggplot(data = titanic, mapping = aes(y =Pclass)) +
geom_bar(fun.y = "mean")
# (21) PclassごとのAgeの平均値を棒グラフで表示する
ggplot(data = titanic, mapping = aes(y =Pclass)) +
geom_bar(stat = "summary",fun.y = "mean")
# (21) PclassごとのAgeの平均値を棒グラフで表示する
ggplot(data = titanic, mapping = aes(x =Pclass, y = Age)) +
geom_bar(stat = "summary",fun.y = "mean")
# (21) PclassごとのAgeの平均値を棒グラフで表示する
ggplot(data = titanic, mapping = aes(x =Pclass, y = Age)) +
geom_bar(stat = "summary",fun.y = "mean") +
labs(y = "Age_mean")
# (22) PclassごとのAgeの標準偏差を棒グラフで表示する
titanic %>% ggplot(data = titanic, mapping = aes(x = Pclass, y = Age)) +
geom_bar(stat = "summary", fun.y = "sd")
# (23) Sexで層別化したPclassごとのAgeの平均値を棒グラフで表示する(横に並べて表示)
ggplot(data = titanic, mapping = aes(x = Pclass, y = Age, fill = Sex)) +
geom_bar(stat = "summary", fun.y = "mean") +
labs(y = "Age_meam_evAex")
# (23) Sexで層別化したPclassごとのAgeの平均値を棒グラフで表示する(横に並べて表示)
ggplot(data = titanic, mapping = aes(x = Pclass, y = Age, fill = Sex)) +
geom_bar(stat = "summary", fun.y = "mean", position = "dodge") +
labs(y = "Age_meam_evAex")
# (24) Sexで層別化したPclassごとのAgeの標準偏差を棒グラフで表示する(横に並べて表示)
ggplot(data = titanic, mapping = aes(x = Pclass, y = Age, fill = Sex)) +
geom_bar(stat = "summary", fun.y = "sd", position = "dodge") +
labs(y = "Age_sd_evAex")
# (24) Sexで層別化したPclassごとのAgeの標準偏差を棒グラフで表示する(横に並べて表示)
ggplot(data = titanic, mapping = aes(x = Pclass, y = Age)) +
geom_bar(stat = "summary", fun.y = "sd", position = "dodge") +
labs(y = "Age_sd_evAex")
# (24) Sexで層別化したPclassごとのAgeの標準偏差を棒グラフで表示する(横に並べて表示)
ggplot(data = titanic, mapping = aes(x = Pclass, y = Age, fill = Sex)) +
geom_bar(stat = "summary", fun.y = "sd", position = "dodge") +
labs(y = "Age_sd_evAex")
# (25) PurvivedごとのPclassの個数を棒グラフで表示する(横に並べて表示)
ggplot(data = titanic, mapping = aes(x = Pclass,fill = Purvived)) +
geom_bar(stat = "summary", fun.y = "count", position = "dodge") +
labs(y = "Age_n_evAex")
# (25) PurvivedごとのPclassの個数を棒グラフで表示する(横に並べて表示)
ggplot(data = titanic, mapping = aes(x = Pclass,fill = Purvived)) +
geom_bar(stat = "summary", fun.y = "count", position = "dodge") +
labs(y = "Age_n_evAex")
# (25) PurvivedごとのPclassの個数を棒グラフで表示する(横に並べて表示)
ggplot(data = titanic, mapping = aes(x = Pclass,fill = Survived)) +
geom_bar(stat = "summary", fun.y = "count", position = "dodge") +
labs(y = "Age_n_evAex")
# (25) PurvivedごとのPclassの個数を棒グラフで表示する(横に並べて表示)
ggplot(data = titanic, mapping = aes(x = Pclass,fill = Survived)) +
geom_bar(stat = "summary", fun.x = "count", position = "dodge") +
labs(y = "Age_n_evAex")
# (25) PurvivedごとのPclassの個数を棒グラフで表示する(横に並べて表示)
ggplot(data = titanic, mapping = aes(x = Survived, y = Pclass)) +
geom_bar(stat = "summary", fun.y = "count", position = "dodge") +
labs(y = "Age_n_evAex")
# (25) PurvivedごとのPclassの個数を棒グラフで表示する(横に並べて表示)
ggplot(data = titanic, mapping = aes(x = Survived, y = Pclass)) +
geom_bar(position = "dodge") +
labs(y = "Age_n_evAex")
# (25) PurvivedごとのPclassの個数を棒グラフで表示する(横に並べて表示)
ggplot(data = titanic, mapping = aes(x = Survived, y = Pclass)) +
geom_bar(fun.y = "count", position = "dodge") +
labs(y = "Age_n_evAex")
# (25) PurvivedごとのPclassの個数を棒グラフで表示する(横に並べて表示)
ggplot(data = titanic, mapping = aes(x = Survived, y = Pclass)) +
geom_bar() +
labs(y = "Age_n_evAex")
# (25) PurvivedごとのPclassの個数を棒グラフで表示する(横に並べて表示)
ggplot(data = titanic, mapping = aes(x = Pclass, fill = Survived)) +
geom_bar(position = "dodge") +
labs(y = "Age_n_evAex")
# (26) SexごとのSurvivedの個数を棒グラフで表示する(横に並べて表示)
ggplot(data = titanic, mapping = aes(x = Suvived, fill = Sex)) +
geom_bar(position = "dodge")
# (26) SexごとのSurvivedの個数を棒グラフで表示する(横に並べて表示)
ggplot(data = titanic, mapping = aes(x = Suvived, fill = Sex)) +
geom_bar(position = "dodge")
# (26) SexごとのSurvivedの個数を棒グラフで表示する(横に並べて表示)
ggplot(data = titanic, mapping = aes(x = Survived, fill = Sex)) +
geom_bar(position = "dodge")
# (27) Survivedで層別化したAge,Fare,SibSpの散布図行列を作成
ggplot(data = titanic, mapping = aes(x = Age, y = Fare, fill = Survived)) +
geom_point()
library(GGally)
titanic %>% select(Age,Fare,SibSp) %>%
ggpairs(aes_string(color = "Survived"))
titanic %>% select(Age,Fare,SibSp) %>%
ggpairs(aes_string(color = Survived))
titanic %>% select(Age,Fare,SibSp,Survived) %>%
ggpairs(aes_string(color = Survived))
titanic %>% select(Age,Fare,SibSp,Survived) %>%
ggpairs(aes_string(color = "Survived"))
titanic %>% select(Survived, Age, Fare, SibSp) %>%
ggpairs(aes_string(color = "Survived", alpha = 0.5))
titanic %>% select(Age,Fare,SibSp,Survived) %>%
ggpairs(aes_string(color = "Survived"))
library(tidyverse)
library(readxl)
library(skimr)
# ------------------------------------------------------------------------------------------
# 練習問題
# ------------------------------------------------------------------------------------------
# データ読み込み
rfm <- read_csv("/Users/yoshikawahiroshi/Documents/R_lesson_tidyverse/r_lesson_4th/RFM.csv")
# データの整形
rfm <- rfm %>% mutate(Sex = if_else(Sex == M, "男性", "女性"),
DM = if_else(DM == "yes", "反応", "無反応"),
C.Age = case_when(Age >= 50 ~ "50代",
Age >= 40 ~ "40代",
Age >= 30 ~ "30代",
Age >= 20 ~ "20代"))
# データの整形
rfm <- rfm %>% mutate(Sex = if_else(Sex == "M", "男性", "女性"),
DM = if_else(DM == "yes", "反応", "無反応"),
C.Age = case_when(Age >= 50 ~ "50代",
Age >= 40 ~ "40代",
Age >= 30 ~ "30代",
Age >= 20 ~ "20代"))
View(rfm)
# (1) Rのヒストグラムを作成する
rfm %>%
ggplot(aes(x = R)) +
geom_histogram()
# (1) Rのヒストグラムを作成する
rfm %>%
ggplot(aes(x = R)) +
geom_histogram(binwidth = 20)
# (1) Rのヒストグラムを作成する
rfm %>%
ggplot(aes(x = R)) +
geom_histogram(binwidth = 10)
# (1) Rのヒストグラムを作成する
rfm %>%
ggplot(aes(x = R)) +
geom_histogram(binwidth = 20)
# (1) Rのヒストグラムを作成する
rfm %>%
ggplot(aes(x = R)) +
geom_histogram(binwidth = 10)
# (1) Rのヒストグラムを作成する
rfm %>%
ggplot(aes(x = R)) +
geom_histogram(binwidth = 20)
# (2) Fのヒストグラムを作成する
ggplot(data = rfm, mapping = aes(x = F)) +
geom_histogram()
# (2) Fのヒストグラムを作成する
ggplot(data = rfm, mapping = aes(x = F)) +
geom_histogram(binwidth = 20)
# (2) Fのヒストグラムを作成する
ggplot(data = rfm, mapping = aes(x = F)) +
geom_histogram(binwidth = 5)
# (2) Fのヒストグラムを作成する
ggplot(data = rfm, mapping = aes(x = F)) +
geom_histogram()
# (2) Fのヒストグラムを作成する
ggplot(data = rfm, mapping = aes(x = F)) +
geom_histogram(bins = 15)
# (3) Mのヒストグラムを作成する
ggplot(data = rfm, aes(x = M)) +
geom_histogram()
# (3) Mのヒストグラムを作成する
ggplot(data = rfm, aes(x = M)) +
geom_histogram(bins = 10)
# (3) Mのヒストグラムを作成する
ggplot(data = rfm, aes(x = M)) +
geom_histogram(bins = 15)
# (4) 男女別のRのヒストグラムを作成し、並べて表示
ggplot(rfm, aes(x = R)) +
geom_histogram() +
facet_grid(Sex ~ .)
# (4) 男女別のRのヒストグラムを作成し、並べて表示
ggplot(rfm, aes(x = R)) +
geom_histogram(binwidth = 10) +
facet_grid(Sex ~ .)
# (4) 男女別のRのヒストグラムを作成し、並べて表示
ggplot(rfm, aes(x = R)) +
geom_histogram(binwidth = 5) +
facet_grid(Sex ~ .)
# (4) 男女別のRのヒストグラムを作成し、並べて表示
ggplot(rfm, aes(x = R)) +
geom_histogram(binwidth = 25) +
facet_grid(Sex ~ .)
# (4) 男女別のRのヒストグラムを作成し、並べて表示
ggplot(rfm, aes(x = R)) +
geom_histogram(binwidth = 25) +
facet_grid(Sex ~ .)
# (4) 男女別のRのヒストグラムを作成し、並べて表示
rfm %>% ggplot(aes(x = R)) +
geom_histogram(binwidth = 20) +
facet_grid(Sex ~ .)
# (4) 男女別のRのヒストグラムを作成し、並べて表示
rfm %>% ggplot(aes(x = R)) +
geom_histogram(binwidth = 20) +
facet_grid(Sex ~ .)
library(tidyverse)
library(readxl)
library(skimr)
# (4) 男女別のRのヒストグラムを作成し、並べて表示
ggplot(rfm, aes(x = R)) +
geom_histogram(binwidth = 25) +
facet_grid(Sex ~ .)
# (4) 男女別のRのヒストグラムを作成し、並べて表示
rfm %>% ggplot(aes(x = R)) +
geom_histogram(binwidth = 20) +
facet_grid(Sex ~ .)
# (4) 男女別のRのヒストグラムを作成し、並べて表示
ggplot(rfm, aes(x = R)) +
geom_histogram(binwidth = 25) +
facet_wrap(Sex ~ .)
ggplot(rfm, aes(x = R)) +
geom_histogram(binwidth = 25) +
facet_wrap(Sex ~ .)
# (5) 男女別にFのヒストグラムを作成し、並べて表示する
rfm %>% ggplot(aes(x = F)) +
geom_histogram(binwidth = 5) +
facet_grid(Sex ~ .)
# (4) 男女別のRのヒストグラムを作成し、並べて表示
ggplot(rfm, aes(x = R)) +
geom_histogram() +
facet_wrap(~. Sex)
# (4) 男女別のRのヒストグラムを作成し、並べて表示
ggplot(rfm, aes(x = R)) +
geom_histogram() +
facet_wrap(Sex ~ .)
# (5) 男女別にFのヒストグラムを作成し、並べて表示する
rfm %>% ggplot(aes(x = F)) +
geom_histogram(binwidth = 5) +
facet_grid(Sex ~ .)
# (4) 男女別のRのヒストグラムを作成し、並べて表示
ggplot(rfm, aes(x = R)) +
geom_histogram() +
facet_wrap(Sex ~ .)
# (5) 男女別にFのヒストグラムを作成し、並べて表示する
rfm %>% ggplot(aes(x = F)) +
geom_histogram(binwidth = 5) +
facet_grid(Sex ~ .)
# (4) 男女別のRのヒストグラムを作成し、並べて表示
ggplot(rfm, aes(x = R)) +
geom_histogram() +
facet_wrap(Sex ~ .)
library(tidyverse)
library(readxl)
library(skimr)
# (4) 男女別のRのヒストグラムを作成し、並べて表示
ggplot(rfm, aes(x = R)) +
geom_histogram() +
facet_wrap(Sex ~ .)
rfm <- rfm %>% mutate(Sex = if_else(Sex == "M", "男性", "女性"),
DM = if_else(DM == "yes", "反応", "無反応"),
C.Age = case_when(Age >= 50 ~ "50代",
Age >= 40 ~ "40代",
Age >= 30 ~ "30代",
Age >= 20 ~ "20代"))
# (1) Rのヒストグラムを作成する
rfm %>%
ggplot(aes(x = R)) +
geom_histogram(binwidth = 20)
# (2) Fのヒストグラムを作成する
ggplot(data = rfm, mapping = aes(x = F)) +
geom_histogram(bins = 15)
# (4) 男女別のRのヒストグラムを作成し、並べて表示
ggplot(rfm, aes(x = R)) +
geom_histogram() +
facet_wrap(Sex ~ .)
# (5) 男女別にFのヒストグラムを作成し、並べて表示する
rfm %>% ggplot(aes(x = F)) +
geom_histogram(binwidth = 5) +
facet_grid(Sex ~ .)
# (9) Sexで層別化したAgeのヒストグラムを重ねて表示する
ggplot(data = titanic, mapping = aes(x = Age,fill = Sex)) +
geom_histogram(binwidth = 5, position = "identity", alpha = 0.5)
# (4) 男女別のRのヒストグラムを作成し、並べて表示
rfm %>% ggplot(aes(x = R)) +
geom_histogram(binwidth = 20) +
facet_grid(Sex ~ .)
# (4) 男女別のRのヒストグラムを作成し、並べて表示
ggplot(rfm, aes(x = R)) +
geom_histogram() +
facet_wrap(Sex ~ .)
# (4) 男女別のRのヒストグラムを作成し、並べて表示
ggplot(rfm, aes(x = R)) +
geom_histogram(binwidth = 50) +
facet_wrap(Sex ~ .)
# (4) 男女別のRのヒストグラムを作成し、並べて表示
ggplot(rfm, aes(x = R)) +
geom_histogram(binwidth = 30) +
facet_wrap(Sex ~ .)
# (6) Pclass別にAgeのヒストグラムを作成し、横に並べて表示する
titanic %>% ggplot(aes(x = Age)) +
geom_histogram(binwidth = 5) +
facet_wrap(Pclass ~ ., nrow = 3)
# (4) 男女別のRのヒストグラムを作成し、並べて表示
ggplot(rfm, aes(x = R)) +
geom_histogram(binwidth = 30) +
facet_wrap(Sex ~ .)
# (6) 男女別にMのヒストグラムを作成し、並べて表示する
rfm %>% ggplot(aes(x = M)) +
geom_histogram(bins = 20) +
facet_grid(Sex ~ .)
# (7) DMで層別化し、Rのヒストグラムを性別ごとに作成し、並べて表示する
rfm %>% ggplot(aes(x = R, fill = DM)) +
geom_histogram(bins = 20, position = "identity", alpha = 0.4) +
facet_grid(Sex ~ .)
# (9) DMで層別化し、Rのヒストグラムを性別ごとに作成し、並べて表示する
rfm %>% ggplot(aes(x = M, fill = DM)) +
geom_histogram(bins = 20, position = "identity", alpha = 0.4) +
facet_grid(Sex ~ .)
# (4) 男女別のRのヒストグラムを作成し、並べて表示
ggplot(rfm, aes(x = R)) +
geom_histogram(binwidth = 30) +
facet_wrap(Sex ~ .)
library(tidyverse)
library(readxl)
library(skimr)
# (5) 男女別にFのヒストグラムを作成し、並べて表示する
rfm %>% ggplot(aes(x = F)) +
geom_histogram(binwidth = 5) +
facet_grid(Sex ~ .)
